<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Flame by nkt</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/nkt/flame">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/nkt/flame/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/nkt/flame/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Flame</h1>
          <p>The PDO wrapper with comfortable API for placeholders</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/nkt">nkt</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="flame" class="anchor" href="#flame"><span class="octicon octicon-link"></span></a>Flame</h1>

<p><a href="https://travis-ci.org/nkt/flame"><img src="https://travis-ci.org/nkt/flame.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/r/nkt/flame?branch=master"><img src="https://img.shields.io/coveralls/nkt/flame.svg" alt="Coverage Status"></a></p>

<p>The PDO wrapper with comfortable API for placeholders</p>

<h2>
<a name="idea" class="anchor" href="#idea"><span class="octicon octicon-link"></span></a>Idea</h2>

<p>Write placeholders types directly in the query</p>

<p>For example:</p>

<div class="highlight highlight-sql"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">goods</span> <span class="k">g</span> <span class="k">WHERE</span> <span class="k">g</span><span class="p">.</span><span class="n">price</span> <span class="k">BETWEEN</span> <span class="n">f</span><span class="p">:</span><span class="n">minPrice</span> <span class="k">AND</span> <span class="n">f</span><span class="p">:</span><span class="n">maxPrice</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="n">u</span> <span class="k">WHERE</span> <span class="n">u</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">s</span><span class="p">:</span><span class="n">username</span><span class="p">;</span> <span class="c1">-- :username also bind as string</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span> <span class="k">WHERE</span> <span class="n">o</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">i</span><span class="p">:</span><span class="n">id</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="n">u</span> <span class="k">WHERE</span> <span class="n">u</span><span class="p">.</span><span class="n">registered</span> <span class="o">&gt;=</span> <span class="n">d</span><span class="p">:</span><span class="nb">date</span><span class="p">;</span>
</pre></div>

<h2>
<a name="difference-between-native-pdo-placeholders" class="anchor" href="#difference-between-native-pdo-placeholders"><span class="octicon octicon-link"></span></a>Difference between native PDO placeholders</h2>

<p>Unlike PDO you can re-use the same placeholder as long as necessary.
Also you have to specifying the type of the placeholder just once.</p>

<div class="highlight highlight-php"><pre><span class="nv">$users</span> <span class="o">=</span> <span class="nv">$flame</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span>
    <span class="s1">'SELECT * FROM users WHERE age &gt;= i:age OR (registered &lt; d:registered AND age = :age)'</span>
<span class="p">)</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">([</span><span class="s1">'age'</span> <span class="o">=&gt;</span> <span class="nv">$age</span><span class="p">]);</span>
</pre></div>

<p>You don't need cast every integer values, Flame do it for you.</p>

<div class="highlight highlight-php"><pre><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$flame</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">'SELECT * FROM users WHERE id = i:id)'</span><span class="p">);</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">([</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]]);</span>
</pre></div>

<p>Every query execution Flame tests value is <code>null</code> and if it is,
change placeholder type to <code>PDO::PARAM_NULL</code>.</p>

<div class="highlight highlight-php"><pre><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$flame</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s1">'INSERT INTO users VALUES(s:username, d:last_login))'</span><span class="p">);</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">([</span><span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'John Doe'</span><span class="p">,</span> <span class="s1">'last_login'</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">]);</span>
</pre></div>

<p>Flame add new types: date and time. You can bind this data as <code>DateTime</code>, <code>string</code> or <code>int</code>.</p>

<h2>
<a name="placeholder-types" class="anchor" href="#placeholder-types"><span class="octicon octicon-link"></span></a>Placeholder types</h2>

<ul>
<li>
<strong>s</strong>: string</li>
<li>
<strong>i</strong>: integer</li>
<li>
<strong>f</strong>: float</li>
<li>
<strong>b</strong>: boolean</li>
<li>
<strong>n</strong>: null</li>
<li>
<strong>l</strong>: blob</li>
<li>
<strong>d</strong>: datetime</li>
<li>
<strong>t</strong>: time</li>
</ul><h1>
<a name="query-builder" class="anchor" href="#query-builder"><span class="octicon octicon-link"></span></a>Query builder</h1>

<p>Flame also provide powerful query builder. Connection provide base wrappers:</p>

<ul>
<li><code>Connection::select(string $column...)</code></li>
<li><code>Connection::update(string $table, array $columns)</code></li>
<li><code>Connection::insert(string $table, array $columns)</code></li>
</ul><p>Every sql statement provides by method with same name in <code>camelCase</code>.</p>

<p>Examples:</p>

<div class="highlight highlight-php"><pre><span class="nv">$posts</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span>
    <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'p.id'</span><span class="p">,</span> <span class="s1">'p.title'</span><span class="p">,</span> <span class="s1">'p.content'</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">'posts p'</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'post_tags pt'</span><span class="p">,</span> <span class="s1">'p.id'</span><span class="p">,</span> <span class="s1">'pt.post_id'</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'tags t'</span><span class="p">,</span> <span class="s1">'t.id'</span><span class="p">,</span> <span class="s1">'pt.tag_id'</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
           <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">equal</span><span class="p">(</span><span class="s1">'t.name'</span><span class="p">,</span> <span class="s1">':tag'</span><span class="p">);</span>
       <span class="p">})</span>
<span class="p">)</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">([</span><span class="s1">'tag'</span> <span class="o">=&gt;</span> <span class="nv">$tag</span><span class="p">]);</span>

<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'username'</span>   <span class="o">=&gt;</span> <span class="s1">':name'</span><span class="p">,</span>
        <span class="s1">'password'</span>   <span class="o">=&gt;</span> <span class="s1">':pass'</span><span class="p">,</span>
        <span class="s1">'registered'</span> <span class="o">=&gt;</span> <span class="s1">'d:now'</span>
    <span class="p">]))</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">([</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="s1">'pass'</span> <span class="o">=&gt;</span> <span class="nv">$pass</span><span class="p">,</span>
        <span class="s1">'now'</span>  <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">()</span>
   <span class="p">]);</span>
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Flame required php 5.4+ and PDO extension.</p>

<p><code>composer require nkt/flame:1.0-dev</code></p>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">Flame\Connection</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Flame\Grammar\MysqlGrammar</span><span class="p">;</span>

<span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Connection</span><span class="p">(</span><span class="s1">'mysql:dbname=hello_world'</span><span class="p">,</span> <span class="s1">'user'</span><span class="p">,</span> <span class="s1">'password'</span><span class="p">,</span> <span class="p">[],</span> <span class="k">new</span> <span class="nx">MysqlGrammar</span><span class="p">());</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
</pre></div>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="LICENSE">MIT</a></p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-37169681-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>